00000000: 2321 2f62 696e 2f73 680a 230a 2320 416e  #!/bin/sh.#.# An
00000010: 2065 7861 6d70 6c65 2068 6f6f 6b20 7363   example hook sc
00000020: 7269 7074 2074 6f20 6368 6563 6b20 7468  ript to check th
00000030: 6520 636f 6d6d 6974 206c 6f67 206d 6573  e commit log mes
00000040: 7361 6765 2e0a 2320 4361 6c6c 6564 2062  sage..# Called b
00000050: 7920 2267 6974 2063 6f6d 6d69 7422 2077  y "git commit" w
00000060: 6974 6820 6f6e 6520 6172 6775 6d65 6e74  ith one argument
00000070: 2c20 7468 6520 6e61 6d65 206f 6620 7468  , the name of th
00000080: 6520 6669 6c65 0a23 2074 6861 7420 6861  e file.# that ha
00000090: 7320 7468 6520 636f 6d6d 6974 206d 6573  s the commit mes
000000a0: 7361 6765 2e20 2054 6865 2068 6f6f 6b20  sage.  The hook 
000000b0: 7368 6f75 6c64 2065 7869 7420 7769 7468  should exit with
000000c0: 206e 6f6e 2d7a 6572 6f0a 2320 7374 6174   non-zero.# stat
000000d0: 7573 2061 6674 6572 2069 7373 7569 6e67  us after issuing
000000e0: 2061 6e20 6170 7072 6f70 7269 6174 6520   an appropriate 
000000f0: 6d65 7373 6167 6520 6966 2069 7420 7761  message if it wa
00000100: 6e74 7320 746f 2073 746f 7020 7468 650a  nts to stop the.
00000110: 2320 636f 6d6d 6974 2e20 2054 6865 2068  # commit.  The h
00000120: 6f6f 6b20 6973 2061 6c6c 6f77 6564 2074  ook is allowed t
00000130: 6f20 6564 6974 2074 6865 2063 6f6d 6d69  o edit the commi
00000140: 7420 6d65 7373 6167 6520 6669 6c65 2e0a  t message file..
00000150: 230a 2320 546f 2065 6e61 626c 6520 7468  #.# To enable th
00000160: 6973 2068 6f6f 6b2c 2072 656e 616d 6520  is hook, rename 
00000170: 7468 6973 2066 696c 6520 746f 2022 636f  this file to "co
00000180: 6d6d 6974 2d6d 7367 222e 0a0a 2320 556e  mmit-msg"...# Un
00000190: 636f 6d6d 656e 7420 7468 6520 6265 6c6f  comment the belo
000001a0: 7720 746f 2061 6464 2061 2053 6967 6e65  w to add a Signe
000001b0: 642d 6f66 662d 6279 206c 696e 6520 746f  d-off-by line to
000001c0: 2074 6865 206d 6573 7361 6765 2e0a 2320   the message..# 
000001d0: 446f 696e 6720 7468 6973 2069 6e20 6120  Doing this in a 
000001e0: 686f 6f6b 2069 7320 6120 6261 6420 6964  hook is a bad id
000001f0: 6561 2069 6e20 6765 6e65 7261 6c2c 2062  ea in general, b
00000200: 7574 2074 6865 2070 7265 7061 7265 2d63  ut the prepare-c
00000210: 6f6d 6d69 742d 6d73 670a 2320 686f 6f6b  ommit-msg.# hook
00000220: 2069 7320 6d6f 7265 2073 7569 7465 6420   is more suited 
00000230: 746f 2069 742e 0a23 0a23 2053 4f42 3d24  to it..#.# SOB=$
00000240: 2867 6974 2076 6172 2047 4954 5f41 5554  (git var GIT_AUT
00000250: 484f 525f 4944 454e 5420 7c20 7365 6420  HOR_IDENT | sed 
00000260: 2d6e 2027 732f 5e5c 282e 2a3e 5c29 2e2a  -n 's/^\(.*>\).*
00000270: 242f 5369 676e 6564 2d6f 6666 2d62 793a  $/Signed-off-by:
00000280: 205c 312f 7027 290a 2320 6772 6570 202d   \1/p').# grep -
00000290: 7173 2022 5e24 534f 4222 2022 2431 2220  qs "^$SOB" "$1" 
000002a0: 7c7c 2065 6368 6f20 2224 534f 4222 203e  || echo "$SOB" >
000002b0: 3e20 2224 3122 0a0a 2320 5468 6973 2065  > "$1"..# This e
000002c0: 7861 6d70 6c65 2063 6174 6368 6573 2064  xample catches d
000002d0: 7570 6c69 6361 7465 2053 6967 6e65 642d  uplicate Signed-
000002e0: 6f66 662d 6279 206c 696e 6573 2e0a 0a74  off-by lines...t
000002f0: 6573 7420 2222 203d 2022 2428 6772 6570  est "" = "$(grep
00000300: 2027 5e53 6967 6e65 642d 6f66 662d 6279   '^Signed-off-by
00000310: 3a20 2720 2224 3122 207c 0a09 2073 6f72  : ' "$1" |.. sor
00000320: 7420 7c20 756e 6971 202d 6320 7c20 7365  t | uniq -c | se
00000330: 6420 2d65 2027 2f5e 5b20 095d 2a31 5b20  d -e '/^[ .]*1[ 
00000340: 095d 2f64 2729 2220 7c7c 207b 0a09 6563  .]/d')" || {..ec
00000350: 686f 203e 2632 2044 7570 6c69 6361 7465  ho >&2 Duplicate
00000360: 2053 6967 6e65 642d 6f66 662d 6279 206c   Signed-off-by l
00000370: 696e 6573 2e0a 0965 7869 7420 310a 7d0a  ines...exit 1.}.
